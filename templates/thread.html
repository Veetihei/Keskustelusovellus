<h2>{{ thread.topic }}</h2>
<p>{{ thread.created_at.strftime("%Y-%m-%d %H:%M:%S") }}</p>
<p>Aloittaja: {{ thread.username }}</p>
{% if session.user_id == thread.user_id or session.role == 2 %}

<form action="/delete_thread/{{ thread.id }}" method="POST">
    <input type="hidden" name="section_id" value="{{ thread.section_id }}">
    <input type="submit" value="Poista ketju">
</form>

{% endif %}
<hr>
{{ thread.message }}
<hr>
<h3>Vastaukset:</h3>
{% for answer in answers %}
<b>Lähetetty: {{ answer.sent_at.strftime("%Y-%m-%d %H:%M:%S") }}</b> <br>
<p>Lähettäjä: {{ answer.username }}</p>
{{ answer.answer }}
<br>
{% if session.user_id == answer.user_id or session.role == 2 %}
<form action="/delete_message/{{ answer.id }}", method="POST">
    <input type="hidden" name="thread_id" value="{{ thread.id }}">
    <input type="submit" value="Poista vastaus">
</form>
{% endif %}
<hr>
{% endfor %}
<hr>
{% if session.role == 1 or session.role == 2 %}
<h3>Vastaa ketjuun</h3>
<form action="/answer/{{ thread.id }}" method="POST" onsubmit="return check(this)">
    <textarea name="message" rows="2" cols="40"></textarea>
    <input type="hidden" name="thread" value="{{ thread.id}}">
    <input type="submit" value="Vastaa ketjuun">
</form>
{% endif %}
<a href="/section/{{ thread.section_id }}">Takaisin</a> | <a href="/reply/{{ id }}")>Vastaa ketjuun</a>

<script>
    function check(form) {
        if (form.message.value.length > 5000) {
            alert("Viesti on liian pitkä, sen pitää olla alle 5000 merkkiä");
            return false;
        }
    }
</script>